<!-- <!DOCTYPE html> -->
<meta charset="utf-8">
<head>
  <title>linghan_vue</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
</head>

<style>
circle {
  fill: orange;
}
</style>

<body>
  <div id="content" class="row">
    <svg  width="900" height="500">
    </svg>
  </div>

  <div class="row">
  	<div class="col-lg-1"></div>
  	<button id="btn_center" class="btn btn-outline-danger" style="margin-right: 2em;">集合！</button>
  	<button id="btn_line" class="btn btn-outline-primary" style="margin-right: 2em;">归队!</button>
  	<button id="btn_dismiss" class="btn btn-outline-success">解散！</button>

  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.2.2/d3.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

  <script>

  	var width = 900, height = 400

			var colorScale = ['#F8971D','#FFD24F', '#6CB33F']
			var xCenter = [100,300,500]

			var numNodes = 100
			var nodes = d3.range(numNodes).map(function(d,i) {
			  return {radius: Math.random() * 25,
			  		  category: i%3}
			});


			

  	function split(){
  		var simulation = d3.forceSimulation(nodes);
			 simulation.force("charge", d3.forceManyBody().strength(5))
			  .force("x", d3.forceX().x(function(d){
			  	return xCenter[d.category];
			  }))
			  .force("collision", d3.forceCollide().radius(function(d) {
			    return d.radius;
			  }))
			  .on("tick", ticked);

		
}

	function dismiss(){
		var simulation = d3.forceSimulation(nodes);
			 simulation.force("charge", d3.forceManyBody().strength(-10))
			 		   .force("center", d3.forceCenter(width/2, height/2-200))
			  		   .force("collision", d3.forceCollide().radius(function(d) {
			    return d.radius;
			  }))
			 		 .on("tick", ticked);
	}

	function go_center(){
		var simulation = d3.forceSimulation(nodes);
		simulation.force("charge", d3.forceManyBody().strength(15))
				  .force("center", d3.forceCenter(width/2, height/2-200))
				  .force("collision", d3.forceCollide().radius(function(d){
								  	return d.radius;
								  }))
				  .on("tick",ticked);
	}

		function ticked() {
				// var canvas = d3.select("svg")
				//   			  .attr("transform","translate(50,200)");

			  var u = d3.select("svg")
			    .selectAll("circle")
			    .data(nodes)

			  u.enter()
			    .append("circle")
			    .attr("r", function(d) {
			      return d.radius
			    })
			    .style("fill",function(d){
			    	return colorScale[d.category];
			    })
			    .merge(u)
			    .attr('cx', function(d) {
			      return d.x
			    })
			    .attr('cy', function(d) {
			      return d.y + 200;
			    })

			  u.exit().remove()
}

dismiss();

$("#btn_center").click(function(){
	go_center();
});

$("#btn_line").click(function(){
	split();
});

$("#btn_dismiss").click(function(){
	dismiss();
})


  </script>
</body>
</html>